
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Build &#8212; The LLDB Debugger</title>
    <link rel="stylesheet" href="../static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/lldb.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Testing" href="test.html" />
    <link rel="prev" title="Getting the Sources" href="source.html" />
   
  <link rel="stylesheet" href="../static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="build">
<h1>Build<a class="headerlink" href="#build" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#preliminaries" id="id5">Preliminaries</a></p>
<ul>
<li><p><a class="reference internal" href="#windows" id="id6">Windows</a></p></li>
<li><p><a class="reference internal" href="#linux" id="id7">Linux</a></p></li>
<li><p><a class="reference internal" href="#macos" id="id8">macOS</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-lldb-with-cmake-ninja" id="id9">Building LLDB with CMake &amp; Ninja</a></p>
<ul>
<li><p><a class="reference internal" href="#regular-in-tree-builds" id="id10">Regular in-tree builds</a></p></li>
<li><p><a class="reference internal" href="#standalone-builds" id="id11">Standalone builds</a></p></li>
<li><p><a class="reference internal" href="#commoncmakeoptions" id="id12">Common CMake options</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id13">Windows</a></p></li>
<li><p><a class="reference internal" href="#netbsd" id="id14">NetBSD</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id15">macOS</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cmakecaches" id="id16">CMake caches</a></p>
<ul>
<li><p><a class="reference internal" href="#common-configurations-on-macos" id="id17">Common configurations on macOS</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-lldb-with-cmake-and-other-generators" id="id18">Building LLDB with CMake and Other Generators</a></p>
<ul>
<li><p><a class="reference internal" href="#visual-studio" id="id19">Visual Studio</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-the-documentation" id="id20">Building The Documentation</a></p></li>
<li><p><a class="reference internal" href="#cross-compiling-lldb" id="id21">Cross-compiling LLDB</a></p>
<ul>
<li><p><a class="reference internal" href="#example-1-cross-compiling-for-linux-arm64-on-ubuntu-host" id="id22">Example 1: Cross-compiling for linux arm64 on Ubuntu host</a></p></li>
<li><p><a class="reference internal" href="#example-2-cross-compiling-for-android-on-linux" id="id23">Example 2: Cross-compiling for Android on Linux</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#verifying-python-support" id="id24">Verifying Python Support</a></p></li>
<li><p><a class="reference internal" href="#code-signing-on-macos" id="id25">Code Signing on macOS</a></p></li>
</ul>
</div>
<div class="section" id="preliminaries">
<h2><a class="toc-backref" href="#id5">Preliminaries</a><a class="headerlink" href="#preliminaries" title="Permalink to this headline">¶</a></h2>
<p>LLDB relies on many of the technologies developed by the larger LLVM project.
In particular, it requires both Clang and LLVM itself in order to build. Due to
this tight integration the Getting Started guides for both of these projects
come as prerequisite reading:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://llvm.org/docs/GettingStarted.html">LLVM</a></p></li>
<li><p><a class="reference external" href="http://clang.llvm.org/get_started.html">Clang</a></p></li>
</ul>
<p>The following requirements are shared on all platforms.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cmake.org">CMake</a></p></li>
<li><p><a class="reference external" href="https://ninja-build.org">Ninja</a> (strongly recommended)</p></li>
<li><p><a class="reference external" href="http://www.python.org/">Python</a></p></li>
<li><p><a class="reference external" href="http://swig.org/">SWIG</a></p></li>
</ul>
<p>Depending on your platform and package manager, one might run any of the
commands below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">libedit</span><span class="o">-</span><span class="n">devel</span> <span class="n">libxml2</span><span class="o">-</span><span class="n">devel</span> <span class="n">ncurses</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">swig</span>
<span class="o">&gt;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">subversion</span> <span class="n">swig</span> <span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">-</span><span class="n">dev</span> <span class="n">libedit</span><span class="o">-</span><span class="n">dev</span> <span class="n">libncurses5</span><span class="o">-</span><span class="n">dev</span>
<span class="o">&gt;</span> <span class="n">pkg</span> <span class="n">install</span> <span class="n">swig</span> <span class="n">python</span>
<span class="o">&gt;</span> <span class="n">pkgin</span> <span class="n">install</span> <span class="n">swig</span> <span class="n">python27</span> <span class="n">cmake</span> <span class="n">ninja</span><span class="o">-</span><span class="n">build</span>
<span class="o">&gt;</span> <span class="n">brew</span> <span class="n">install</span> <span class="n">swig</span> <span class="n">cmake</span> <span class="n">ninja</span>
</pre></div>
</div>
<div class="section" id="windows">
<h3><a class="toc-backref" href="#id6">Windows</a><a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Visual Studio 2015 or greater</p></li>
<li><p>Windows SDK 8.0 or higher. In general it is best to use the latest available
version.</p></li>
<li><p><a class="reference external" href="http://gnuwin32.sourceforge.net/">GnuWin32</a></p></li>
<li><p><a class="reference external" href="https://www.python.org/downloads/windows/">Python 3.5 or higher</a> or
higher. Earlier versions of Python can be made to work by compiling your own
distribution from source, but this workflow is unsupported and you are own
your own.</p></li>
<li><p><a class="reference external" href="https://github.com/Microsoft/PTVS/releases">Python Tools for Visual Studio</a>. If you plan to debug test
failures or even write new tests at all, PTVS is an indispensable debugging
extension to VS that enables full editing and debugging support for Python
(including mixed native/managed debugging)</p></li>
</ul>
<p>The steps outlined here describes how to set up your system and install the
required dependencies such that they can be found when needed during the build
process. They only need to be performed once.</p>
<ol class="arabic simple">
<li><p>Install Visual Studio and the Windows SDK.</p></li>
<li><p>Install GnuWin32, making sure <code class="docutils literal notranslate"><span class="pre">&lt;GnuWin32</span> <span class="pre">install</span> <span class="pre">dir&gt;\bin</span></code> is added to
your PATH environment variable.</p></li>
<li><p>Install SWIG for Windows, making sure <code class="docutils literal notranslate"><span class="pre">&lt;SWIG</span> <span class="pre">install</span> <span class="pre">dir&gt;</span></code> is added to
your PATH environment variable.</p></li>
</ol>
<p>Any command prompt from which you build LLDB should have a valid Visual Studio
environment setup. This means you should run <code class="docutils literal notranslate"><span class="pre">vcvarsall.bat</span></code> or open an
appropriate Visual Studio Command Prompt corresponding to the version you wish
to use.</p>
</div>
<div class="section" id="linux">
<h3><a class="toc-backref" href="#id7">Linux</a><a class="headerlink" href="#linux" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://www.thrysoee.dk/editline">libedit</a></p></li>
</ul>
</div>
<div class="section" id="macos">
<h3><a class="toc-backref" href="#id8">macOS</a><a class="headerlink" href="#macos" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>To use the in-tree debug server on macOS, lldb needs to be code signed. For
more information see <a class="reference internal" href="#codesigning"><span class="std std-ref">Code Signing on macOS</span></a> below.</p></li>
<li><p>If you are building both Clang and LLDB together, be sure to also check out
libc++, which is a required for testing on macOS.</p></li>
</ul>
</div>
</div>
<div class="section" id="building-lldb-with-cmake-ninja">
<h2><a class="toc-backref" href="#id9">Building LLDB with CMake &amp; Ninja</a><a class="headerlink" href="#building-lldb-with-cmake-ninja" title="Permalink to this headline">¶</a></h2>
<p>The LLVM project is migrating to a single monolithic respository for LLVM and
its subprojects. This is the recommended way to build LLDB. Checkout the
source-tree with git:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llvm</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>CMake is a cross-platform build-generator tool. CMake does not build the
project, it generates the files needed by your build tool. The recommended
build tool for LLVM is Ninja.</p>
<div class="section" id="regular-in-tree-builds">
<h3><a class="toc-backref" href="#id10">Regular in-tree builds</a><a class="headerlink" href="#regular-in-tree-builds" title="Permalink to this headline">¶</a></h3>
<p>Create a new directory for your build-tree. From there run CMake and point it
to the <code class="docutils literal notranslate"><span class="pre">llvm</span></code> directory in the source-tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span> <span class="o">-</span><span class="n">DLLVM_ENABLE_PROJECTS</span><span class="o">=</span><span class="s2">&quot;clang;lldb&quot;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">cmake</span> <span class="n">options</span><span class="o">&gt;</span><span class="p">]</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">llvm</span>
</pre></div>
</div>
<p>We used the <code class="docutils literal notranslate"><span class="pre">LLVM_ENABLE_PROJECTS</span></code> option here to tell the build-system which
subprojects to build in addition to LLVM (for more options see <a class="reference external" href="#commoncmakeoptions">Common CMake
Options</a> and <a class="reference external" href="#cmakecaches">CMake Caches</a>). Now run ninja to perform the actual build.
We pass <code class="docutils literal notranslate"><span class="pre">lldb</span></code> here as the target, so it only builds what is necessary to run
the lldb driver:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">ninja</span> <span class="n">lldb</span>
</pre></div>
</div>
</div>
<div class="section" id="standalone-builds">
<h3><a class="toc-backref" href="#id11">Standalone builds</a><a class="headerlink" href="#standalone-builds" title="Permalink to this headline">¶</a></h3>
<p>This is another way to build LLDB. We can use the same source-tree as we
checked out above, but now we will have two build-trees:</p>
<ul class="simple">
<li><p>the main build-tree for LLDB in <code class="docutils literal notranslate"><span class="pre">/path/to/lldb-build</span></code></p></li>
<li><p>a provided build-tree for LLVM and Clang in <code class="docutils literal notranslate"><span class="pre">/path/to/llvm-build</span></code></p></li>
</ul>
<p>Run CMake with <code class="docutils literal notranslate"><span class="pre">-B</span></code> pointing to a new directory for the provided build-tree
and the positional argument pointing to the <code class="docutils literal notranslate"><span class="pre">llvm</span></code> directory in the
source-tree. Note that we leave out LLDB here and only include Clang (and libcxx
on macOS). Then we build the <code class="docutils literal notranslate"><span class="pre">ALL</span></code> target with ninja:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span> \
        <span class="o">-</span><span class="n">DLLVM_ENABLE_PROJECTS</span><span class="o">=</span><span class="n">clang</span> \
        <span class="p">[</span><span class="o">&lt;</span><span class="n">more</span> <span class="n">cmake</span> <span class="n">options</span><span class="o">&gt;</span><span class="p">]</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">llvm</span>
<span class="o">&gt;</span> <span class="n">ninja</span>
</pre></div>
</div>
<p>Now run CMake a second time with <code class="docutils literal notranslate"><span class="pre">-B</span></code> pointing to a new directory for the
main build-tree and the positional argument pointing to the <code class="docutils literal notranslate"><span class="pre">lldb</span></code> directory
in the source-tree. In order to find the provided build-tree, the build-system
needs the options <code class="docutils literal notranslate"><span class="pre">LLVM_DIR</span></code> and <code class="docutils literal notranslate"><span class="pre">Clang_DIR</span></code> (CMake variables are
case-sensitive!):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">lldb</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span> \
        <span class="o">-</span><span class="n">DLLVM_DIR</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">llvm</span> \
        <span class="o">-</span><span class="n">DClang_DIR</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">clang</span> \
        <span class="p">[</span><span class="o">&lt;</span><span class="n">more</span> <span class="n">cmake</span> <span class="n">options</span><span class="o">&gt;</span><span class="p">]</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">lldb</span>
<span class="o">&gt;</span> <span class="n">ninja</span> <span class="n">lldb</span>
</pre></div>
</div>
</div>
<div class="section" id="commoncmakeoptions">
<span id="id1"></span><h3><a class="toc-backref" href="#id12">Common CMake options</a><a class="headerlink" href="#commoncmakeoptions" title="Permalink to this headline">¶</a></h3>
<p>Following is a description of some of the most important CMake variables which
you are likely to encounter. A variable FOO is set by adding <code class="docutils literal notranslate"><span class="pre">-DFOO=value</span></code> to
the CMake command line.</p>
<p>If you want to debug the lldb that you’re building – that is, build it with
debug info enabled – pass two additional arguments to cmake before running
ninja:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span> \
    <span class="o">-</span><span class="n">DLLDB_EXPORT_ALL_SYMBOLS</span><span class="o">=</span><span class="mi">1</span> \
    <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Debug</span>
    <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">root</span> <span class="n">of</span> <span class="n">llvm</span> <span class="n">source</span> <span class="n">tree</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>If you want to run the test suite, you will need a compiler to build the test
programs. If you have Clang checked out, that will be used by default.
Alternatively, you can specify a C and C++ compiler to be used by the test
suite.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span> \
    <span class="o">-</span><span class="n">DLLDB_TEST_USE_CUSTOM_C_COMPILER</span><span class="o">=</span><span class="n">On</span> \
    <span class="o">-</span><span class="n">DLLDB_TEST_USE_CUSTOM_CXX_COMPILER</span><span class="o">=</span><span class="n">On</span> \
    <span class="o">-</span><span class="n">DLLDB_TEST_C_COMPILER</span><span class="o">=&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">C</span> <span class="n">compiler</span><span class="o">&gt;</span> \
    <span class="o">-</span><span class="n">DLLDB_TEST_CXX_COMPILER</span><span class="o">=&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">C</span><span class="o">++</span> <span class="n">compiler</span><span class="o">&gt;</span> \
    <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">root</span> <span class="n">of</span> <span class="n">llvm</span> <span class="n">source</span> <span class="n">tree</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>It is strongly recommend to use a release build for the compiler to speed up
test execution.</p>
<div class="section" id="id2">
<h4><a class="toc-backref" href="#id13">Windows</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Although the following CMake variables are by no means Windows specific, they
are commonly used on Windows.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LLDB_TEST_DEBUG_TEST_CRASHES</span></code> (Default=0): If set to 1, will cause Windows
to generate a crash dialog whenever lldb.exe or the python extension module
crashes while running the test suite. If set to 0, LLDB will silently crash.
Setting to 1 allows a developer to attach a JIT debugger at the time of a
crash, rather than having to reproduce a failure or use a crash dump.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PYTHON_HOME</span></code> (Required): Path to the folder where the Python distribution
is installed. For example, <code class="docutils literal notranslate"><span class="pre">C:\Python35</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LLDB_RELOCATABLE_PYTHON</span></code> (Default=0): When this is 0, LLDB will bind
statically to the location specified in the <code class="docutils literal notranslate"><span class="pre">PYTHON_HOME</span></code> CMake variable,
ignoring any value of <code class="docutils literal notranslate"><span class="pre">PYTHONHOME</span></code> set in the environment. This is most
useful for developers who simply want to run LLDB after they build it. If you
wish to move a build of LLDB to a different machine where Python will be in a
different location, setting <code class="docutils literal notranslate"><span class="pre">LLDB_RELOCATABLE_PYTHON</span></code> to 1 will cause
Python to use its default mechanism for finding the python installation at
runtime (looking for installed Pythons, or using the <code class="docutils literal notranslate"><span class="pre">PYTHONHOME</span></code>
environment variable if it is specified).</p></li>
</ul>
<p>Sample command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span><span class="o">^</span>
    <span class="o">-</span><span class="n">DLLDB_TEST_DEBUG_TEST_CRASHES</span><span class="o">=</span><span class="mi">1</span><span class="o">^</span>
    <span class="o">-</span><span class="n">DPYTHON_HOME</span><span class="o">=</span><span class="n">C</span><span class="p">:</span>\<span class="n">Python35</span><span class="o">^</span>
    <span class="o">-</span><span class="n">DLLDB_TEST_USE_CUSTOM_C_COMPILER</span><span class="o">=</span><span class="n">ON</span><span class="o">^</span>
    <span class="o">-</span><span class="n">DLLDB_TEST_C_COMPILER</span><span class="o">=</span><span class="n">d</span><span class="p">:</span>\<span class="n">src</span>\<span class="n">llvmbuild</span>\<span class="n">ninja_release</span>\<span class="nb">bin</span>\<span class="n">clang</span><span class="o">.</span><span class="n">exe</span><span class="o">^</span>
    <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">root</span> <span class="n">of</span> <span class="n">llvm</span> <span class="n">source</span> <span class="n">tree</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="netbsd">
<h4><a class="toc-backref" href="#id14">NetBSD</a><a class="headerlink" href="#netbsd" title="Permalink to this headline">¶</a></h4>
<p>Current stable NetBSD release doesn’t ship with libpanel(3), therefore it’s
required to disable curses(3) support with the
<code class="docutils literal notranslate"><span class="pre">-DLLDB_DISABLE_CURSES:BOOL=TRUE</span></code> option. To make sure check if
<code class="docutils literal notranslate"><span class="pre">/usr/include/panel.h</span></code> exists in your system.</p>
</div>
<div class="section" id="id3">
<h4><a class="toc-backref" href="#id15">macOS</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Here are some commonly used LLDB-specific CMake variables on macOS.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LLDB_BUILD_FRAMEWORK:BOOL</span></code> : Builds the LLDB.framework.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LLDB_CODESIGN_IDENTITY:STRING</span></code> : Determines the codesign identity to use.
The default is <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> (see the <a class="reference external" href="#codesigning">Code-signing section</a>).</p></li>
</ul>
</div>
</div>
<div class="section" id="cmakecaches">
<span id="id4"></span><h3><a class="toc-backref" href="#id16">CMake caches</a><a class="headerlink" href="#cmakecaches" title="Permalink to this headline">¶</a></h3>
<p>CMake caches allow to store common sets of configuration options in the form of
CMake scripts and can be useful to reproduce builds for particular use-cases
(similar to their <a class="reference external" href="http://llvm.org/docs/AdvancedBuilds.html">usage in LLVM and Clang</a>).
They are passed to CMake with the <code class="docutils literal notranslate"><span class="pre">-C</span></code> flag, following the absolute path to
the file on disk. Subsequent <code class="docutils literal notranslate"><span class="pre">-D</span></code> options are still allowed. Please find the
currently available caches in the <a class="reference external" href="https://github.com/llvm/llvm-project/tree/master/lldb/cmake/caches">lldb/cmake/caches/</a>
directory.</p>
<div class="section" id="common-configurations-on-macos">
<h4><a class="toc-backref" href="#id17">Common configurations on macOS</a><a class="headerlink" href="#common-configurations-on-macos" title="Permalink to this headline">¶</a></h4>
<p>Build, test and install LLDB from the <a class="reference external" href="https://github.com/llvm/llvm-project">monorepo</a> (see also <a class="reference external" href="http://llvm.org/docs/BuildingADistribution.html">Building a Distribution of
LLVM</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llvm</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span>

<span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">lldb</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span> \
        <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">lldb</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">caches</span><span class="o">/</span><span class="n">Apple</span><span class="o">-</span><span class="n">lldb</span><span class="o">-</span><span class="n">macOS</span><span class="o">.</span><span class="n">cmake</span> \
        <span class="o">-</span><span class="n">DLLVM_ENABLE_PROJECTS</span><span class="o">=</span><span class="s2">&quot;clang;libcxx;lldb&quot;</span> \
        <span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">llvm</span>

<span class="o">&gt;</span> <span class="n">DESTDIR</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">lldb</span><span class="o">-</span><span class="n">install</span> <span class="n">ninja</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">lldb</span><span class="o">-</span><span class="n">build</span> <span class="n">check</span><span class="o">-</span><span class="n">lldb</span> <span class="n">install</span><span class="o">-</span><span class="n">distribution</span>
</pre></div>
</div>
<p>Build LLDB standalone for development with Xcode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">llvm</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span>

<span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">G</span> <span class="n">Ninja</span>
        <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">lldb</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">caches</span><span class="o">/</span><span class="n">Apple</span><span class="o">-</span><span class="n">lldb</span><span class="o">-</span><span class="n">base</span><span class="o">.</span><span class="n">cmake</span> \
        <span class="o">-</span><span class="n">DLLVM_ENABLE_PROJECTS</span><span class="o">=</span><span class="s2">&quot;clang;libcxx&quot;</span> \
        <span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">llvm</span>
<span class="o">&gt;</span> <span class="n">ninja</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span>

<span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">B</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">lldb</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">G</span> <span class="n">Xcode</span>
        <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">lldb</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">caches</span><span class="o">/</span><span class="n">Apple</span><span class="o">-</span><span class="n">lldb</span><span class="o">-</span><span class="n">Xcode</span><span class="o">.</span><span class="n">cmake</span> \
        <span class="o">-</span><span class="n">DLLVM_DIR</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">llvm</span> \
        <span class="o">-</span><span class="n">DClang_DIR</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">build</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="n">clang</span> \
        <span class="n">llvm</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">lldb</span>
<span class="o">&gt;</span> <span class="nb">open</span> <span class="n">lldb</span><span class="o">.</span><span class="n">xcodeproj</span>
<span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">lldb</span><span class="o">-</span><span class="n">build</span> <span class="o">--</span><span class="n">target</span> <span class="n">check</span><span class="o">-</span><span class="n">lldb</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="building-lldb-with-cmake-and-other-generators">
<h2><a class="toc-backref" href="#id18">Building LLDB with CMake and Other Generators</a><a class="headerlink" href="#building-lldb-with-cmake-and-other-generators" title="Permalink to this headline">¶</a></h2>
<p>Compiling with ninja is both faster and simpler than compiling with MSVC, but
chances are you still want to debug LLDB with an IDE. One solution is to run
cmake twice and generate the output into two different folders. One for
compiling (the ninja folder), and one for editing, browsing and debugging.</p>
<div class="section" id="visual-studio">
<h3><a class="toc-backref" href="#id19">Visual Studio</a><a class="headerlink" href="#visual-studio" title="Permalink to this headline">¶</a></h3>
<p>Follow the previous instructions in one directory, and generate a Visual Studio
project in another directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">cmake</span> <span class="o">-</span><span class="n">G</span> <span class="s2">&quot;Visual Studio 14 2015&quot;</span> <span class="o">&lt;</span><span class="n">cmake</span> <span class="n">variables</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">root</span> <span class="n">of</span> <span class="n">llvm</span> <span class="n">source</span> <span class="n">tree</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Then you can open the .sln file in Visual Studio, set lldb as the startup
project, and use F5 to run it. You need only edit the project settings to set
the executable and the working directory to point to binaries inside of the
ninja tree.</p>
</div>
</div>
<div class="section" id="building-the-documentation">
<h2><a class="toc-backref" href="#id20">Building The Documentation</a><a class="headerlink" href="#building-the-documentation" title="Permalink to this headline">¶</a></h2>
<p>If you wish to build the optional (reference) documentation, additional
dependencies are required:</p>
<ul class="simple">
<li><p>Sphinx (for the website)</p></li>
<li><p>Graphviz (for the ‘dot’ tool)</p></li>
<li><p>doxygen (if you wish to build the C++ API reference)</p></li>
<li><p>epydoc (if you wish to build the Python API reference)</p></li>
</ul>
<p>To install the prerequisites for building the documentation (on Debian/Ubuntu)
do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">doxygen</span> <span class="n">graphviz</span> <span class="n">python3</span><span class="o">-</span><span class="n">sphinx</span>
<span class="o">&gt;</span> <span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">epydoc</span>
</pre></div>
</div>
<p>To build the documentation, configure with <code class="docutils literal notranslate"><span class="pre">LLVM_ENABLE_SPHINX=ON</span></code> and build the desired target(s).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">ninja</span> <span class="n">docs</span><span class="o">-</span><span class="n">lldb</span><span class="o">-</span><span class="n">html</span>
<span class="o">&gt;</span> <span class="n">ninja</span> <span class="n">lldb</span><span class="o">-</span><span class="n">cpp</span><span class="o">-</span><span class="n">doc</span>
<span class="o">&gt;</span> <span class="n">ninja</span> <span class="n">lldb</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">doc</span>
</pre></div>
</div>
</div>
<div class="section" id="cross-compiling-lldb">
<h2><a class="toc-backref" href="#id21">Cross-compiling LLDB</a><a class="headerlink" href="#cross-compiling-lldb" title="Permalink to this headline">¶</a></h2>
<p>In order to debug remote targets running different architectures than your
host, you will need to compile LLDB (or at least the server component) for the
target. While the easiest solution is to just compile it locally on the target,
this is often not feasible, and in these cases you will need to cross-compile
LLDB on your host.</p>
<p>Cross-compilation is often a daunting task and has a lot of quirks which depend
on the exact host and target architectures, so it is not possible to give a
universal guide which will work on all platforms. However, here we try to
provide an overview of the cross-compilation process along with the main things
you should look out for.</p>
<p>First, you will need a working toolchain which is capable of producing binaries
for the target architecture. Since you already have a checkout of clang and
lldb, you can compile a host version of clang in a separate folder and use
that. Alternatively you can use system clang or even cross-gcc if your
distribution provides such packages (e.g., <code class="docutils literal notranslate"><span class="pre">g++-aarch64-linux-gnu</span></code> on
Ubuntu).</p>
<p>Next, you will need a copy of the required target headers and libraries on your
host. The libraries can be usually obtained by copying from the target machine,
however the headers are often not found there, especially in case of embedded
platforms. In this case, you will need to obtain them from another source,
either a cross-package if one is available, or cross-compiling the respective
library from source. Fortunately the list of LLDB dependencies is not big and
if you are only interested in the server component, you can reduce this even
further by passing the appropriate cmake options, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DLLDB_DISABLE_LIBEDIT</span><span class="o">=</span><span class="mi">1</span>
<span class="o">-</span><span class="n">DLLDB_DISABLE_CURSES</span><span class="o">=</span><span class="mi">1</span>
<span class="o">-</span><span class="n">DLLDB_DISABLE_PYTHON</span><span class="o">=</span><span class="mi">1</span>
<span class="o">-</span><span class="n">DLLVM_ENABLE_TERMINFO</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
<p>In this case you, will often not need anything other than the standard C and
C++ libraries.</p>
<p>Once all of the dependencies are in place, it’s just a matter of configuring
the build system with the locations and arguments of all the necessary tools.
The most important cmake options here are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_CROSSCOMPILING</span></code> : Set to 1 to enable cross-compilation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_LIBRARY_ARCHITECTURE</span></code> : Affects the cmake search path when looking
for libraries. You may need to set this to your architecture triple if you do
not specify all your include and library paths explicitly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_C_COMPILER</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_COMPILER</span></code> : C and C++ compilers for the
target architecture</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_C_FLAGS</span></code>, <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_FLAGS</span></code> : The flags for the C and C++ target
compilers. You may need to specify the exact target cpu and abi besides the
include paths for the target headers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMAKE_EXE_LINKER_FLAGS</span></code> : The flags to be passed to the linker. Usually
just a list of library search paths referencing the target libraries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LLVM_TABLEGEN</span></code>, <code class="docutils literal notranslate"><span class="pre">CLANG_TABLEGEN</span></code> : Paths to llvm-tblgen and clang-tblgen
for the host architecture. If you already have built clang for the host, you
can point these variables to the executables in your build directory. If not,
you will need to build the llvm-tblgen and clang-tblgen host targets at
least.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LLVM_HOST_TRIPLE</span></code> : The triple of the system that lldb (or lldb-server)
will run on. Not setting this (or setting it incorrectly) can cause a lot of
issues with remote debugging as a lot of the choices lldb makes depend on the
triple reported by the remote platform.</p></li>
</ul>
<p>You can of course also specify the usual cmake options like
<code class="docutils literal notranslate"><span class="pre">CMAKE_BUILD_TYPE</span></code>, etc.</p>
<div class="section" id="example-1-cross-compiling-for-linux-arm64-on-ubuntu-host">
<h3><a class="toc-backref" href="#id22">Example 1: Cross-compiling for linux arm64 on Ubuntu host</a><a class="headerlink" href="#example-1-cross-compiling-for-linux-arm64-on-ubuntu-host" title="Permalink to this headline">¶</a></h3>
<p>Ubuntu already provides the packages necessary to cross-compile LLDB for arm64.
It is sufficient to install packages <code class="docutils literal notranslate"><span class="pre">gcc-aarch64-linux-gnu</span></code>,
<code class="docutils literal notranslate"><span class="pre">g++-aarch64-linux-gnu</span></code>, <code class="docutils literal notranslate"><span class="pre">binutils-aarch64-linux-gnu</span></code>. Then it is possible
to prepare the cmake build with the following parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DCMAKE_CROSSCOMPILING</span><span class="o">=</span><span class="mi">1</span> \
<span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">gcc</span> \
<span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">-</span><span class="n">g</span><span class="o">++</span> \
<span class="o">-</span><span class="n">DLLVM_HOST_TRIPLE</span><span class="o">=</span><span class="n">aarch64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span> \
<span class="o">-</span><span class="n">DLLVM_TABLEGEN</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">host</span><span class="o">&gt;/</span><span class="nb">bin</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">tblgen</span> \
<span class="o">-</span><span class="n">DCLANG_TABLEGEN</span><span class="o">=&lt;</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">host</span><span class="o">&gt;/</span><span class="nb">bin</span><span class="o">/</span><span class="n">clang</span><span class="o">-</span><span class="n">tblgen</span> \
<span class="o">-</span><span class="n">DLLDB_DISABLE_PYTHON</span><span class="o">=</span><span class="mi">1</span> \
<span class="o">-</span><span class="n">DLLDB_DISABLE_LIBEDIT</span><span class="o">=</span><span class="mi">1</span> \
<span class="o">-</span><span class="n">DLLDB_DISABLE_CURSES</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>An alternative (and recommended) way to compile LLDB is with clang.
Unfortunately, clang is not able to find all the include paths necessary for a
successful cross-compile, so we need to help it with a couple of CFLAGS
options. In my case it was sufficient to add the following arguments to
<code class="docutils literal notranslate"><span class="pre">CMAKE_C_FLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">CMAKE_CXX_FLAGS</span></code> (in addition to changing
<code class="docutils literal notranslate"><span class="pre">CMAKE_C(XX)_COMPILER</span></code> to point to clang compilers):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">target</span> <span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span> \
<span class="o">-</span><span class="n">I</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="mf">4.8</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span> \
<span class="o">-</span><span class="n">I</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">aarch64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">include</span>
</pre></div>
</div>
<p>If you wanted to build a full version of LLDB and avoid passing
<code class="docutils literal notranslate"><span class="pre">-DLLDB_DISABLE_PYTHON</span></code> and other options, you would need to obtain the
target versions of the respective libraries. The easiest way to achieve this is
to use the qemu-debootstrap utility, which can prepare a system image using
qemu and chroot to simulate the target environment. Then you can install the
necessary packages in this environment (python-dev, libedit-dev, etc.) and
point your compiler to use them using the correct -I and -L arguments.</p>
</div>
<div class="section" id="example-2-cross-compiling-for-android-on-linux">
<h3><a class="toc-backref" href="#id23">Example 2: Cross-compiling for Android on Linux</a><a class="headerlink" href="#example-2-cross-compiling-for-android-on-linux" title="Permalink to this headline">¶</a></h3>
<p>In the case of Android, the toolchain and all required headers and libraries
are available in the Android NDK.</p>
<p>The NDK also contains a cmake toolchain file, which makes configuring the build
much simpler. The compiler, include and library paths will be configured by the
toolchain file and all you need to do is to select the architecture
(ANDROID_ABI) and platform level (<code class="docutils literal notranslate"><span class="pre">ANDROID_PLATFORM</span></code>, should be at least 21).
You will also need to set <code class="docutils literal notranslate"><span class="pre">ANDROID_ALLOW_UNDEFINED_SYMBOLS=On</span></code>, as the
toolchain file defaults to “no undefined symbols in shared libraries”, which is
not compatible with some llvm libraries. The first version of NDK which
supports this approach is r14.</p>
<p>For example, the following arguments are sufficient to configure an android
arm64 build:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-DCMAKE_TOOLCHAIN_FILE=$ANDROID_NDK_HOME/build/cmake/android.toolchain.cmake \
-DANDROID_ABI=arm64-v8a \
-DANDROID_PLATFORM=android-21 \
-DANDROID_ALLOW_UNDEFINED_SYMBOLS=On \
-DLLVM_HOST_TRIPLE=aarch64-unknown-linux-android \
-DCROSS_TOOLCHAIN_FLAGS_NATIVE=&#39;-DCMAKE_C_COMPILER=cc;-DCMAKE_CXX_COMPILER=c++&#39;
</pre></div>
</div>
<p>Note that currently only lldb-server is functional on android. The lldb client
is not supported and unlikely to work.</p>
</div>
</div>
<div class="section" id="verifying-python-support">
<h2><a class="toc-backref" href="#id24">Verifying Python Support</a><a class="headerlink" href="#verifying-python-support" title="Permalink to this headline">¶</a></h2>
<p>LLDB has a Python scripting capability and supplies its own Python module named
lldb. If a script is run inside the command line lldb application, the Python
module is made available automatically. However, if a script is to be run by a
Python interpreter outside the command line application, the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>
environment variable can be used to let the Python interpreter find the lldb
module.</p>
<p>The correct path can be obtained by invoking the command line lldb tool with
the -P flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; export PYTHONPATH=`$llvm/build/Debug+Asserts/bin/lldb -P`
</pre></div>
</div>
<p>If you used a different build directory or made a release build, you may need
to adjust the above to suit your needs. To test that the lldb Python module is
built correctly and is available to the default Python interpreter, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import lldb&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="code-signing-on-macos">
<span id="codesigning"></span><h2><a class="toc-backref" href="#id25">Code Signing on macOS</a><a class="headerlink" href="#code-signing-on-macos" title="Permalink to this headline">¶</a></h2>
<p>To use the in-tree debug server on macOS, lldb needs to be code signed. The
Debug, DebugClang and Release builds are set to code sign using a code signing
certificate named <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code>. This document explains how to set up the
signing certificate.</p>
<p>Note that it’s possible to build and use lldb on macOS without setting up code
signing by using the system’s debug server. To configure lldb in this way with
cmake, specify <code class="docutils literal notranslate"><span class="pre">-DLLDB_USE_SYSTEM_DEBUGSERVER=ON</span></code>.</p>
<p>If you have re-installed a new OS, please delete all old <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> items
from your keychain. There will be a code signing certification and a public
and private key. Reboot after deleting them. You will also need to delete and
build folders that contained old signed items. The darwin kernel will cache
code signing using the executable’s file system node, so you will need to
delete the file so the kernel clears its cache.</p>
<p>Automatic setup:</p>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">scripts/macos-setup-codesign.sh</span></code></p></li>
</ul>
<p>Manual setup steps:</p>
<ul class="simple">
<li><p>Launch /Applications/Utilities/Keychain Access.app</p></li>
<li><p>In Keychain Access select the <code class="docutils literal notranslate"><span class="pre">login</span></code> keychain in the <code class="docutils literal notranslate"><span class="pre">Keychains</span></code> list in
the upper left hand corner of the window.</p></li>
<li><p>Select the following menu item: Keychain Access-&gt;Certificate Assistant-&gt;Create a Certificate…</p></li>
<li><p>Set the following settings</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Name</span> <span class="o">=</span> <span class="n">lldb_codesign</span>
<span class="n">Identity</span> <span class="n">Type</span> <span class="o">=</span> <span class="n">Self</span> <span class="n">Signed</span> <span class="n">Root</span>
<span class="n">Certificate</span> <span class="n">Type</span> <span class="o">=</span> <span class="n">Code</span> <span class="n">Signing</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Click Create</p></li>
<li><p>Click Continue</p></li>
<li><p>Click Done</p></li>
<li><p>Click on the “My Certificates”</p></li>
<li><p>Double click on your new <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> certificate</p></li>
<li><p>Turn down the “Trust” disclosure triangle, scroll to the “Code Signing” trust
pulldown menu and select “Always Trust” and authenticate as needed using your
username and password.</p></li>
<li><p>Drag the new <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> code signing certificate (not the public or
private keys of the same name) from the <code class="docutils literal notranslate"><span class="pre">login</span></code> keychain to the <code class="docutils literal notranslate"><span class="pre">System</span></code>
keychain in the Keychains pane on the left hand side of the main Keychain
Access window. This will move this certificate to the <code class="docutils literal notranslate"><span class="pre">System</span></code> keychain.
You’ll have to authorize a few more times, set it to be “Always trusted” when
asked.</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">~/Desktop/lldb_codesign.cer</span></code> file on your desktop if there is one.</p></li>
<li><p>In the Keychain Access GUI, click and drag <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> in the
<code class="docutils literal notranslate"><span class="pre">System</span></code> keychain onto the desktop. The drag will create a
<code class="docutils literal notranslate"><span class="pre">Desktop/lldb_codesign.cer</span></code> file used in the next step.</p></li>
<li><p>Switch to Terminal, and run the following:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">security</span> <span class="n">add</span><span class="o">-</span><span class="n">trust</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">r</span> <span class="n">trustRoot</span> <span class="o">-</span><span class="n">p</span> <span class="n">basic</span> <span class="o">-</span><span class="n">p</span> <span class="n">codeSign</span> <span class="o">-</span><span class="n">k</span> <span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Keychains</span><span class="o">/</span><span class="n">System</span><span class="o">.</span><span class="n">keychain</span> <span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">lldb_codesign</span><span class="o">.</span><span class="n">cer</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">lldb_codesign</span><span class="o">.</span><span class="n">cer</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Drag the <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> certificate from the <code class="docutils literal notranslate"><span class="pre">System</span></code> keychain back into
the <code class="docutils literal notranslate"><span class="pre">login</span></code> keychain</p></li>
<li><p>Quit Keychain Access</p></li>
<li><p>Reboot</p></li>
<li><p>Clean by removing all previously creating code signed binaries and rebuild
lldb and you should be able to debug.</p></li>
</ul>
<p>When you build your LLDB for the first time, the Xcode GUI will prompt you for
permission to use the <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> keychain. Be sure to click “Always
Allow” on your first build. From here on out, the <code class="docutils literal notranslate"><span class="pre">lldb_codesign</span></code> will be
trusted and you can build from the command line without having to authorize.
Also the first time you debug using a LLDB that was built with this code
signing certificate, you will need to authenticate once.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">LLDB</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Goals &amp; Status</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../status/goals.html">Goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../status/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../status/status.html">Status</a></li>
<li class="toctree-l1"><a class="reference internal" href="../status/projects.html">Projects</a></li>
</ul>
<p class="caption"><span class="caption-text">Use &amp; Extension</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../use/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/map.html">GDB to LLDB command map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/formatting.html">Frame and Thread Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/variable.html">Variable Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/symbolication.html">Symbolication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/symbols.html">Symbols on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/python.html">Python Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/python-reference.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/remote.html">Remote Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/architecture.html">Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="download.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="source.html">Getting the Sources</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="bots.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sbapi.html">The SB API Coding Rules</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/python_reference/index.html">Public Python API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/namespacelldb.html">Public C++ API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/index.html">Private C++ Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://llvm.org/viewvc/llvm-project/lldb/trunk/">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://reviews.llvm.org">Code Reviews</a></li>
<li class="toctree-l1"><a class="reference external" href="https://bugs.llvm.org/">Bug Reports</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="source.html" title="previous chapter">Getting the Sources</a></li>
      <li>Next: <a href="test.html" title="next chapter">Testing</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2007-2019, The LLDB Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>